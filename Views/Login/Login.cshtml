@{
	Layout = null;
}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
<meta http-equiv="Cross-Origin-Opener-Policy" content="same-origin-allow-popups">

<style>
	* {
		margin: 0;
		padding: 0;
		box-sizing: border-box;
		font-family: "poppins",sans-serif;
	}

	.background {
		/* 最下層背景 */
		background: url('@Url.Content("~/images/login.jpg")');
		/* background-color: #98979783; */
		background-position: center;
		background-size: cover;
		height: 100vh;
		width: 100%;
		/* margin-top:50px; */
		filter: blur(2px);
	}

	.main {
		position: absolute;
		left: 50%;
		top: 50%;
		transform: translate(-50%,-50%);
		width: 75%;
		height: 700px;
		/* margin-top: 50px; */

		background: url('@Url.Content("~/images/login.jpg")');
		/* background-image: linear-gradient(to right bottom, rgb(40, 42, 55) 0%, rgb(40, 42, 55) 20%, rgba(40, 42, 55, 0.9) 60%, rgba(17, 22, 50, 0.4) 100%),url(../images/login.jpg); */
		background-position: center;
		background-size: cover;
		border-radius: 20px;
		overflow: hidden;
	}


		/*中間白色透明背景*/
		.main .login-section {
			position: absolute;
			left: 50%;
			transform: translate(-50%,0);
			/* margin:0 auto; */
			/* width: calc(100% - 58%); */
			width: 500px;
			height: 100%;
			color: #fff;
			background-color: rgba(88, 85, 85, 0.2);
			/* backdrop-filter: blur(4px); */
		}

	.login-section .form-box, .register-section .form-box {
		position: absolute;
		display: flex;
		justify-content: center;
		align-items: center;
		width: 100%;
		height: 100%;
	}
	/* 登入註冊版面上下切換*/
	.login-section .register {
		margin-bottom: 50px;
		transform: translateY(100%);
		/*transform: translateY(0px);*/
		transition: transform .6s ease;
		transition-delay: 0s;
	}

	.login-section.active .register { /*按註冊連結(在登入畫面)，將註冊section往上*/
		transform: translateY(0px);
		transition-delay: .7s;
	}

	.login-section .login {
		margin-bottom: 50px;
		transform: translateY(0px);
		transition: transform .6s ease;
		transition-delay: 0.7s;
	}

	.login-section.active .login { /*按登入連結(在註冊畫面)，將登入section往上*/
		transform: translateY(100%);
		transition-delay: 0s;
	}



	.login h2, .register h2 {
		text-align: center;
		font-size: 30px;
		margin: 20px 0 5px 0;
	}

	.login h5, .register h5 {
		text-align: center;
		font-size: 16px;
	}

	.form-box .input-box {
		width: 400px;
		height: 50px;
		border-bottom: 2px solid#fff;
		margin: 26px 0;
		position: relative;
	}


	.input-box input {
		height: 100%;
		color: #fff;
		background: transparent;
		border: none;
		outline: none;
		font-size: 18px;
		position: absolute;
		top: 50%;
		transform: translateY(-40%);
		width: 350px;
		padding-left: 10px;
		text-transform: none;
	}

	.input-box label {
		position: absolute;
		top: 50%;
		left: 0;
		transform: translateY(-30%);
		font-size: 16px;
		pointer-events: none;
		transition: .5s ease;
	}

	.input-box .icon i{
		position: absolute;
		top: 13px;
		right: 0;
		font-size: 19px;
	}

	.input-box i {
		/*position: absolute;
		top: 13px;
		right: 0;*/
		font-size: 19px;
		color: white;
		margin-right: 5px;
	}
	/*文字向上漂浮*/
	.input-box input:focus ~ label,
	.input-box input:valid ~ label {
		top: -5px;
	}


	.remember-password {
		font-size: 14px;
		font-weight: 500;
		letter-spacing: 1px;
		margin: -15px 0 15px;
		display: flex;
		justify-content: space-between;
	}

		.remember-password label input {
			accent-color: #fff;
			margin-right: 3px;
		}

		.remember-password a {
			letter-spacing: 1px;
			color: #fff;
			text-decoration: none;
		}

			.remember-password a:hover {
				text-decoration: underline;
			}

	.login .btn, .register .btn {
		/* background: #fff; */
		width: 100%;
		height: 45px;
		outline: none;
		border: none;
		border-radius: 4px;
		cursor: pointer;
		background: #4F9D9D;
		font-size: 16px;
		color: #fff;
		box-shadow: rgba(0,0,0,0.4);
		font-weight: bolder;
	}

		.login .btn:hover, .register .btn:hover {
			background: transparent;
			border: 1px solid #4f9d9d;
			border-radius: 2px;
			color: #4f9d9d;
		}

	.create-account {
		margin-top: 50px;
		background-color: rgba(248, 248, 248, 0.1);
	}

		.create-account p {
			font-size: 14.5px;
			text-align: center;
			line-height: 2.5;
		}

		.create-account a {
			color: #fff;
			font-weight: bolder;
			text-decoration: none;
		}

			.create-account a:hover {
				text-decoration: underline;
			}

	.other-login {
		transform: translate(0, -60%);
	}

		.other-login .divider {
			width: 100%;
			margin: 80px 0 30px 0;
			text-align: center;
			display: flex;
			align-items: center;
			justify-content: space-between;
		}

			.other-login .divider .line {
				display: inline-block;
				max-width: 30%;
				width: 30%;
				flex: 1;
				height: 1px;
				background-color: #fff;
			}

			.other-login .divider .divider-text {
				vertical-align: middle;
				margin: 0px 20px;
				line-height: 0;
				display: inline-block;
				width: 100px;
				color: #fff;
				font-size: 15px;
			}

		.other-login .other-login-wrapper {
			width: 100%;
			display: flex;
			justify-content: center;
			align-items: center;
			
		}

	.pwdVisibility {
		color: white;
		font-size: 16px;
		background-color: transparent;
		border: none;
		margin-right: 12px;
		cursor: pointer;
	}

</style>


<title>登入</title>
<div class="background"></div>
<article>
	<div class="main container">
		<div class="row login-section">
			<div class="form-box login col-md-12">
				<form id="Login">
					@Html.AntiForgeryToken()
					<h2>Log In</h2>
					<h5>會員登入</h5>
					<div class="create-account">
						<p>
							還沒有帳號?
							<a href="#register" class="register-link">進行會員註冊</a>
							@*<a href="https://localhost:5000/Login/Register" class="register-link">進行會員註冊</a>*@
						</p>
					</div>
					<div class="input-box">
						@*<span class="icon"><i class="bi bi-person-circle"></i></span>*@
						<input type="text" id="MemberLoginAccount" name="MemberAccount" class="form-control" autocomplete="off" required />
						<label><i class="bi bi-person-circle"></i>帳號</label>
					</div>
					<div class="input-box">
						<span class="icon">
							<button type="button" class="pwdVisibility" id="toggleLoginPassword" onclick="togglePasswordVisibility('MemberLoginPassword', 'toggleLoginPassword')">
								<i class="bi bi-eye"></i>
							</button>
						</span>
						<input type="password" id="MemberLoginPassword" name="MemberPassword" class="form-control" autocomplete="off" required />
						<label><i class="bi bi-lock-fill"></i>密碼</label>
					</div>
					<div class="remember-password">
						<label for="checkbox"><input type="checkbox" id="checkbox" class="remeber_account" />記住帳號</label>
						<a href="https://localhost:5000/Login/forgetPassword" class="forget_password">忘記密碼</a>
					</div>
					<input type="submit" value="登入" id="loginButton" class="btn btn-default" />
					<div class="other-login">
						<div class="divider">
							<span class="line"></span>
							<span class="divider-text">其他登入方式</span>
							<span class="line"></span>
						</div>
						<div class="other-login-wrapper">
							<div id="g_id_onload"
								 data-client_id="24117042909-f73r9qksf4se9ka68pgdviie2ucsl4h4.apps.googleusercontent.com"
								 data-login_uri="https://localhost:5000/Login/ValidGoogleLogin"
								 data-auto_prompt="false">
							</div>
							<div class="g_id_signin"
								 data-type="standard"
								 data-size="large"
								 data-theme="outline"
								 data-text="sign_in_with"
								 data-shape="rectangular"
								 data-logo_alignment="left">
							</div>
						</div>
					</div>
				</form>
			</div>
			<!--註冊會員-->
			<div class="form-box register col-md-12 ">
				<form id="Register">
					@Html.AntiForgeryToken()
					<h2>Sign Up</h2>
					<h5>會員註冊</h5>
					<div class="create-account">
						<p>
							已經有帳號?
							<a href="#login" class="login-link">進入會員登入</a>
							@*@Html.ActionLink("進入會員登入", "Login",null,new {  @class = "login-link"  })*@
						</p>
					</div>
					@Html.ValidationSummary(true, "", new { @class = "text-danger" })

					<div class="input-box">
						<input type="text" id="memberRegisterAccount" name="memberAccount" class="form-control" autocomplete="off" required />
						<label><i class="bi bi-person-circle"></i>帳號</label>
					</div>
					<div class="input-box">
						<span class="icon">
							<button type="button" class="pwdVisibility" id="toggleRegisterPassword" onclick="togglePasswordVisibility('memberRegisterPassword', 'toggleRegisterPassword')">
								<i class="bi bi-eye"></i>
							</button>
						</span>
						<input type="password" id="memberRegisterPassword" name="memberPassword" class="form-control" autocomplete="off" required />
						<label><i class="bi bi-lock-fill"></i>密碼</label>
					</div>
					<div class="input-box input-chkpassword">
						<span class="icon">
							<button type="button" class="pwdVisibility" id="toggleConfirmPassword" onclick="togglePasswordVisibility('memberConfirmPassword', 'toggleConfirmPassword')">
								<i class="bi bi-eye"></i>
							</button>
						</span>
						<input type="password" id="memberConfirmPassword" name="memberConfirmPassword" class="form-control chkpassword" autocomplete="off" required />
						<label><i class="bi bi-lock-fill"></i>確認密碼</label>
					</div>
					<button class="btn">下一步</button>
					<div class="other-login">
						<div class="divider">
							<span class="line"></span>
							<span class="divider-text">其他註冊方式</span>
							<span class="line"></span>
						</div>
						<div class="other-login-wrapper">
							<div id="g_id_onload"
								 data-client_id="24117042909-f73r9qksf4se9ka68pgdviie2ucsl4h4.apps.googleusercontent.com"
								 data-login_uri="https://localhost:5000/Login/ValidGoogleLogin"
								 data-auto_prompt="false">
							</div>
							<div class="g_id_signin"
								 data-type="standard"
								 data-size="large"
								 data-theme="outline"
								 data-text="sign_in_with"
								 data-shape="rectangular"
								 data-logo_alignment="left">
							</div>
						</div>
					</div>
				</form>
			</div>
		</div>
	</div>
</article>
<!-- SIGN UP FORM CREATION -->
<script src="https://accounts.google.com/gsi/client" async defer></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js"></script>
<script>
	const loginsec = document.querySelector('.login-section')
	const loginlink = document.querySelector('.login-link')
	const registerlink = document.querySelector('.register-link')
	registerlink.addEventListener('click', () => {
		loginsec.classList.add('active')
	})
	loginlink.addEventListener('click', () => {
		loginsec.classList.remove('active')
	})


	function togglePasswordVisibility(inputId, toggleButtonId) {
		var passwordInput = document.getElementById(inputId);
		var toggleButton = document.getElementById(toggleButtonId);

		if (passwordInput.type === "password") {
			passwordInput.type = "text";
			toggleButton.innerHTML = '<i class="bi bi-eye-slash"></i>';
		} else {
			passwordInput.type = "password";
			toggleButton.innerHTML = '<i class="bi bi-eye"></i>';
		}
	}

	






	//Login表單傳送到後端
	document.getElementById("Login").addEventListener("submit", function (event) {
		event.preventDefault();

		let MemberAccount = document.getElementById("MemberLoginAccount").value;
		let MemberPassword = document.getElementById("MemberLoginPassword").value;

		if ((MemberAccount.trim() === "") || (MemberPassword.trim() === "")) {
			alert("請輸入帳號和密碼!");
			return false;
		}

		const formData =
		{
			memberAccount: MemberAccount,
			memberPassword: MemberPassword
		}

		//const formData = document.getElementById("Login");
		console.log(JSON.stringify(formData));

		$.ajax({
			type: "POST",
			url: "/api/Members/Login",
			data: JSON.stringify(formData),
			contentType: "application/json"
		}).done(data => {
			//alert(data);
			if (!data.success) {
				alert("登入失敗!");
				return;
			}
			window.location.href = "https://localhost:5000/Home/Index";

		}).fail((jqXHR, textStatus, errorThrown) => {
			if (jqXHR.status === 400) {
				const errorResponse = jqXHR.responseJSON;
				alert(errorResponse.message);
			} else {
				console.error("AJAX error:", textStatus, errorThrown);
			}
		});
		return false;
	});


	//註冊區塊
	//function togglePasswordVisibility() {
	//	let memberPassword = document.getElementById("memberPassword");
	//	let toggleButton = document.getElementById("togglePassword");

	//	if (memberPassword.type === "password") {
	//		memberPassword.type = "text";
	//		toggleButton.innerHTML = '<i class="bi bi-eye-slash"></i>';
	//	} else {
	//		memberPassword.type = "password";
	//		toggleButton.innerHTML = '<i class="bi bi-eye"></i>';
	//	}


	//}

	//function toggleChkPasswordVisibility() {
	//	let memberConfirmPassword = document.getElementById("memberConfirmPassword");
	//	let toggleChkButton = document.getElementById("toggleChkPassword");

	//	if (memberConfirmPassword.type === "password") {
	//		memberConfirmPassword.type = "text";
	//		toggleChkButton.innerHTML = '<i class="bi bi-eye-slash"></i>';
	//	} else {
	//		memberConfirmPassword.type = "password";
	//		toggleChkButton.innerHTML = '<i class="bi bi-eye"></i>';

	//	}
	//}


	////Register 表單傳送到後端
	document.getElementById("Register").addEventListener("submit", function (event) {
		event.preventDefault();

		let memberAccount = document.getElementById("memberRegisterAccount").value;
		let memberPassword = document.getElementById("memberRegisterPassword").value;
		let memberConfirmPassword = document.getElementById("memberConfirmPassword").value;

		let accountPattern = /^[a-zA-Z0-9]{6,12}$/;
		if (!accountPattern.test(memberAccount)) {
			alert("帳號必須為6到12位的英數字組合");
			return false; //取消預設的事件行為，阻止表單的提交。
		} else if ((memberAccount.trim() === "") || (memberPassword.trim() === "") || (memberConfirmPassword.trim() === "")) {
			alert("請輸入所有欄位!");
			return false;
		}

		let passwordPattern = /^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,20}$/;
		if (!passwordPattern.test(memberPassword)) {
			alert("密碼必須包含至少一個數字、一個小寫字母和一個大寫字母，且長度在8到20之間");
			return false;
		}

		if (memberConfirmPassword !== memberPassword) {
			alert("請確認密碼是否相同!")
			return false;
		}



		const formData =
		{
			memberAccount: memberAccount,
			memberPassword: memberPassword
		}

		console.log(JSON.stringify(formData));

		$.ajax({
			type: "POST",
			url: "/api/Members/Register",
			data: JSON.stringify(formData),
			contentType: "application/json"
		}).done(data => {
			//alert(data);
			if (!data.success) {
				alert(data.message);
				return false;
			}
			window.location.href = "https://localhost:5000/Login/registerProfile";

		}).fail((jqXHR, textStatus, errorThrown) => {
			if (jqXHR.status === 400) {
				const errorResponse = jqXHR.responseJSON;
				alert(errorResponse.message);
			} else {
				console.error("AJAX error:", textStatus, errorThrown);
			}
		});
		return false;
	});



</script>



